<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cqjtu.bookstore.dao.AuthorInfoDao">
	
	<insert id="addAuthorInfo" parameterType="AuthorInfo">
		insert into author_info(author_id,author_name,author_tele,author_email,author_password,author_avatar,author_vip,enroll_date,end_date) 
		values(#{authorId},#{authorName},#{authorTele},#{authorEmail},#{authorPassword},#{authorAvatar},#{authorVip},#{enrollDate},#{endDate})
	</insert>
	
	<delete id="deleteAuthorInfo" parameterType="AuthorInfo">
		delete from author_info where author_id = #{authorId}
	</delete>
	
	<update id="updateAuthorInfo" parameterType="AuthorInfo">
		update author_info set author_name = #{authorName},
		author_tele = #{authorTele},
		author_email = #{authorEmail},
		author_password = #{authorPassword},
		author_avatar = #{authorAvatar},
		author_vip = #{authorVip},
		enroll_date = #{enrollDate},
		end_date = #{endDate}
		where author_id = #{authorId}
	</update>
	
	<resultMap type="AuthorInfo" id="authorinfomap">
		<id column="author_id" property="authorId"/>
		<result column="author_name" property="authorName"/>
		<result column="author_tele" property="authorTele"/>
		<result column="author_email" property="authorEmail"/>
		<result column="author_password" property="authorPassword"/>
		<result column="author_avatar" property="authorAvatar"/>
		<result column="author_vip" property="authorVip"/>
		<result column="enroll_date" property="enrollDate"/>
		<result column="end_date" property="endDate"/>
		<collection property="novelInfos" ofType="NovelInfo">
			<id column="novel_id" property="novelId"/>
			<result column="novel_name" property="novelName"/>
			<result column="novel_style" property="novelStyle"/>
			<result column="novel_status" property="novelStatus"/>
			<result column="novel_attribute" property="novelAttribute"/>
			<result column="novel_synopsis" property="novelSynopsis"/>
			<result column="novel_lable" property="novelLable"/>
			<result column="novel_image" property="novelImage"/>
			<result column="create_date" property="createDate"/>
			<result column="update_date" property="updateDate"/>
			<result column="novel_grade" property="novelGrade"/>
			<result column="novel_count" property="novelCount"/>
			<result column="pageview_count" property="pageviewCount"/>
			<result column="collection_count" property="collectionCount"/>
			<result column="praise_count" property="praiseCount"/>
		</collection>
	</resultMap>
	
	<select id="queryAuthorInfoCount" parameterType="AuthorInfo"
	resultType="Long" >
		select count(*) from author_info a left outer join novel_info n on a.author_id = n.author_id
		<where>
			<if test="authorId != null and authorId !=''">
				and a.author_id = #{authorId}
			</if>
			<if test="authorName != null and authorName !=''">
				and a.author_name = #{authorName}
			</if>
			<if test="authorTele != null and authorTele !=''">
				and a.author_tele = #{authorTele}
			</if>
			<if test="authorEmail != null and authorEmail !=''">
				and a.author_email = #{authorEmail}
			</if>
			<if test="author_vip != null and authorVip !=''">
				and a.author_vip = #{authorVip}
			</if>
		</where>
	</select>
	
	<select id="queryAuthorInfo" parameterType="AuthorInfo"
	resultType="List" resultMap="authorinfomap">
		select * from author_info a left outer join novel_info n on a.author_id = n.author_id
		<where>
			<if test="authorId != null and authorId !=''">
				and a.author_id = #{authorId}
			</if>
			<if test="authorName != null and authorName !=''">
				and a.author_name = #{authorName}
			</if>
			<if test="authorTele != null and authorTele !=''">
				and a.author_tele = #{authorTele}
			</if>
			<if test="authorEmail != null and authorEmail !=''">
				and a.author_email = #{authorEmail}
			</if>
			<if test="author_vip != null and authorVip !=''">
				and a.author_vip = #{authorVip}
			</if>
		</where>
		<!-- order by a.#{order} desc -->
	</select>

</mapper>